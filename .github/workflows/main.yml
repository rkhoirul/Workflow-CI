name: MLflow Model Training Workflow

on:
  push:
    branches:
      - main  # Menjalankan workflow pada push ke branch main
  pull_request:
    branches:
      - main  # Menjalankan workflow pada pull request ke branch main

jobs:
  build:
    runs-on: ubuntu-latest  # Menjalankan pekerjaan di environment Ubuntu

    steps:
      # Langkah 1: Checkout repository
      - name: Checkout repository
        uses: actions/checkout@v4

      # Langkah 2: Set up Miniconda and create/activate environment from file
      - name: Set up Miniconda
        uses: conda-incubator/setup-miniconda@v3
        with:
          environment-file: MLProject/conda.yml  # Menggunakan file conda.yml untuk environment
          activate-environment: heart-disease-env  # Nama environment sesuai conda.yml

      # Langkah 3: Jalankan Skrip Model (misalnya modelling.py)
      - name: Run modelling.py
        run: conda run -n heart-disease-env --no-capture-output python MLProject/modelling.py
